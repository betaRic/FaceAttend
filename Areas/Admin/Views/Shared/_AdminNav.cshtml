@{
    // Using route values avoids false "active" matches.
    // Example: Url.Action for Dashboard often returns /Admin, which is a prefix of every Admin route.

    string curCtrl = (ViewContext.RouteData.Values["controller"] as string ?? "").Trim().ToLowerInvariant();
    string curAct  = (ViewContext.RouteData.Values["action"] as string ?? "").Trim().ToLowerInvariant();

    bool onDash     = (curCtrl == "dashboard");
    bool onEmp      = (curCtrl == "employees");
    bool onOff      = (curCtrl == "offices");
    bool onAtt      = (curCtrl == "attendance" && curAct == "index");
    bool onSummary  = (curCtrl == "attendance" && curAct == "summaryreport");
    bool onVisitors = (curCtrl == "visitors");
    bool onSet      = (curCtrl == "settings");
}

<nav class="admin-nav" aria-label="Admin navigation">
    <div class="admin-nav-section">
        <div class="admin-nav-title">Menu</div>

        <a class="admin-nav-link @(onDash ? "active" : "")"
           href="@Url.Action("Index", "Dashboard", new { area = "Admin" })">
            <span class="admin-nav-icon"><i class="fa-solid fa-gauge-high" aria-hidden="true"></i></span>
            Dashboard
        </a>

        <a class="admin-nav-link @(onEmp ? "active" : "")"
           href="@Url.Action("Index", "Employees", new { area = "Admin" })">
            <span class="admin-nav-icon"><i class="fa-solid fa-users" aria-hidden="true"></i></span>
            Employees
        </a>

        <a class="admin-nav-link @(onOff ? "active" : "")"
           href="@Url.Action("Index", "Offices", new { area = "Admin" })">
            <span class="admin-nav-icon"><i class="fa-solid fa-building" aria-hidden="true"></i></span>
            Offices
        </a>

        <a class="admin-nav-link @(onAtt ? "active" : "")"
           href="@Url.Action("Index", "Attendance", new { area = "Admin" })">
            <span class="admin-nav-icon"><i class="fa-solid fa-clock" aria-hidden="true"></i></span>
            Attendance
        </a>

        <a class="admin-nav-link @(onSummary ? "active" : "")"
           href="@Url.Action("SummaryReport", "Attendance", new { area = "Admin" })">
            <span class="admin-nav-icon"><i class="fa-solid fa-chart-column" aria-hidden="true"></i></span>
            Summary Report
        </a>

        <a class="admin-nav-link @(onVisitors ? "active" : "")"
           href="@Url.Action("Index", "Visitors", new { area = "Admin" })">
            <span class="admin-nav-icon"><i class="fa-solid fa-user-check" aria-hidden="true"></i></span>
            Visitors
        </a>
    </div>

    <hr class="admin-nav-sep" />

    <div class="admin-nav-section">
        <div class="admin-nav-title">Admin</div>

        <a class="admin-nav-link @(onSet ? "active" : "")"
           href="@Url.Action("Index", "Settings", new { area = "Admin" })">
            <span class="admin-nav-icon"><i class="fa-solid fa-gear" aria-hidden="true"></i></span>
            Settings
        </a>
    </div>
</nav>
